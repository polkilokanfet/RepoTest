<inf:ViewBase x:Class="HVTApp.UI.TaskInvoiceForPayment1.ForManager.TaskInvoiceForPaymentManagerView"
              xmlns:inf="clr-namespace:HVTApp.Infrastructure;assembly=HVTApp.Infrastructure"
              xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
              xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
              xmlns:infgDp="http://infragistics.com/DataPresenter" 
              xmlns:igEditors="http://infragistics.com/Editors"
              xmlns:history="clr-namespace:HVTApp.UI.TechnicalRequrementsTasksModule.Task.History"
              xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
              xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
              xmlns:forManager="clr-namespace:HVTApp.UI.TaskInvoiceForPayment1.ForManager"
              mc:Ignorable="d"
              d:DataContext="{d:DesignInstance forManager:TaskInvoiceForPaymentViewModelManager, IsDesignTimeCreatable=True}"
              >
    
    <inf:ViewBase.Resources>
        <BooleanToVisibilityConverter x:Key="VisibilityConverter"/>

        <Style x:Key="BoltFontCellsStyle" TargetType="{x:Type infgDp:CellValuePresenter}">
            <Setter Property="ForegroundStyle">
                <Setter.Value>
                    <Style>
                        <!--<Setter Property="TextBlock.Background" Value="Aqua" />-->
                        <Setter Property="TextBlock.FontWeight" Value="Bold" />
                        <!--<Setter Property="TextBlock.FontStyle" Value="Italic"/>-->
                    </Style>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="PaymentsCellStyle"
               TargetType="{x:Type infgDp:CellValuePresenter}">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type infgDp:CellValuePresenter}">
                        <StackPanel Orientation="Horizontal">
                            <Button Content="..."
                                    Command="{Binding DataContext.ChangePaymentsCommand, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type UserControl}}}"
                                    CommandParameter="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Record.DataItem}" />
                            <TextBlock Text="{TemplateBinding Value}"
                                       VerticalAlignment="Center" />
                        </StackPanel>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

    </inf:ViewBase.Resources>

    <GroupBox Header="Задание на формирование счёта">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <Grid Grid.Row="0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <Label Grid.Column="0" Content="Требуется оригинал счёта: "/>
                <CheckBox Grid.Column="1" IsChecked="{Binding Task.OriginalIsRequired, UpdateSourceTrigger=PropertyChanged}" HorizontalAlignment="Left" IsEnabled="{Binding IsStarted, UpdateSourceTrigger=PropertyChanged, Converter={StaticResource ReverseBoolConverter}}"/>

            </Grid>

            <GroupBox Grid.Row="1" Header="Комментарий менеджера">
                <TextBox Text="{Binding Task.Comment, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
            </GroupBox>

            <GroupBox Grid.Row="2" Header="Спецификация">
                <Grid>
                    <Grid.Resources>
                        <Style TargetType="TextBox">
                            <Style.Setters>
                                <Setter Property="IsReadOnly" Value="True"/>
                                <Setter Property="VerticalAlignment" Value="Center"/>
                                <Setter Property="BorderThickness" Value="0"/>
                            </Style.Setters>
                        </Style>

                    </Grid.Resources>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <Label Grid.Column="0" Grid.Row="0" Content="№ спецификации:"/>
                    <TextBox Grid.Column="1" Grid.Row="0" Text="{Binding Mode=OneWay}"/>

                    <Label Grid.Column="0" Grid.Row="1" Content="Дата спецификации:"/>
                    <TextBox Grid.Column="1" Grid.Row="1" Text="{Binding Mode=OneWay}"/>

                    <Label Grid.Column="0" Grid.Row="2" Content=""/>
                    <TextBox Grid.Column="1" Grid.Row="2" Text="{Binding Mode=OneWay}"/>

                    <Label Grid.Column="0" Grid.Row="" Content=""/>
                    <TextBox Grid.Column="1" Grid.Row="" Text="{Binding Mode=OneWay}"/>

                </Grid>
            </GroupBox>

            <infgDp:XamDataGrid x:Name="Groups"
                                Grid.Row="1" Grid.Column="0"
                                DataSource="{Binding Task.Items}"
                                ActiveDataItem="{Binding SelectedItem, Mode=TwoWay}">

                <infgDp:XamDataGrid.ContextMenu>
                    <ContextMenu>
                        <MenuItem Header="Export to Excel" Command="{Binding ExportToExcel}" CommandParameter="{Binding PlacementTarget, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type ContextMenu}}}"/>
                    </ContextMenu>
                </infgDp:XamDataGrid.ContextMenu>
                <infgDp:XamDataGrid.FieldLayouts>
                    <infgDp:FieldLayout Key="Main">

                        <infgDp:FieldLayout.Fields>

                            <infgDp:TextField AlternateBinding="{Binding TceNumber}"
                                        BindingType="UseAlternateBinding"
                                        Label="Заявка в Team Center"
                                        Width="Auto"
                                        AllowResize="True" />

                            <infgDp:TextField AlternateBinding="{Binding FacilityOwners}"
                                        BindingType="UseAlternateBinding"
                                        Label="Владелец объекта"
                                        Width="Auto"
                                        AllowResize="True" />

                            <infgDp:TextField AlternateBinding="{Binding Facility}"
                                        BindingType="UseAlternateBinding"
                                        Label="Объект"
                                        Width="Auto"
                                        AllowResize="True" />

                            <infgDp:TextField AlternateBinding="{Binding ProductType}"
                                        BindingType="UseAlternateBinding"
                                        Label="Тип продукта"
                                        Width="Auto"
                                        AllowResize="True" />

                            <infgDp:TextField AlternateBinding="{Binding Designation}"
                                        BindingType="UseAlternateBinding"
                                        Label="Обозначение"
                                        Width="Auto"
                                        AllowResize="True" />

                            <infgDp:NumericField AlternateBinding="{Binding Amount}"
                                           BindingType="UseAlternateBinding"
                                           Label="Кол."
                                           Width="Auto"
                                           AllowResize="True" />

                            <infgDp:NumericField AlternateBinding="{Binding Cost}"
                                           BindingType="UseAlternateBinding"
                                           Label="Цена"
                                           Width="Auto"
                                           AllowResize="True" />

                            <infgDp:NumericField AlternateBinding="{Binding Sum}"
                                           BindingType="UseAlternateBinding"
                                           Label="Стоимость"
                                           Width="Auto"
                                           AllowResize="True" />

                            <infgDp:NumericField AlternateBinding="{Binding Vat}"
                                           BindingType="UseAlternateBinding"
                                           Label="НДС, %"
                                           Width="Auto"
                                           AllowResize="True" />

                            <infgDp:NumericField AlternateBinding="{Binding SumWithVat}"
                                           BindingType="UseAlternateBinding"
                                           Label="Стоимость с НДС"
                                           Width="Auto"
                                           AllowResize="True" />

                            <infgDp:NumericField AlternateBinding="{Binding CostDelivery}"
                                           BindingType="UseAlternateBinding"
                                           Label="Логистика"
                                           Width="Auto"
                                           AllowResize="True" />

                            <infgDp:NumericField AlternateBinding="{Binding FixedCost}"
                                           BindingType="UseAlternateBinding"
                                           Label="Шеф-монтаж"
                                           Width="Auto"
                                           AllowResize="True" />

                            <infgDp:TextField AlternateBinding="{Binding Order}"
                                        BindingType="UseAlternateBinding"
                                        Label="Заказ"
                                        Width="Auto"
                                        AllowResize="True" />

                            <infgDp:TextField AlternateBinding="{Binding OrderPositions}"
                                        BindingType="UseAlternateBinding"
                                        Label="Позиции"
                                        Width="Auto"
                                        AllowResize="True" />

                            <infgDp:TextField AlternateBinding="{Binding Contragent}"
                                        BindingType="UseAlternateBinding"
                                        Label="Контрагент"
                                        Width="Auto"
                                        AllowResize="True" />

                            <infgDp:TextField AlternateBinding="{Binding ContragentType}"
                                        BindingType="UseAlternateBinding"
                                        Label="Тип контрагента"
                                        Width="Auto"
                                        AllowResize="True" />

                            <infgDp:TextField AlternateBinding="{Binding Country}"
                                        BindingType="UseAlternateBinding"
                                        Label="Страна поставки"
                                        Width="Auto"
                                        AllowResize="True" />

                            <infgDp:TextField AlternateBinding="{Binding District}"
                                        BindingType="UseAlternateBinding"
                                        Label="Федеральный округ"
                                        Width="Auto"
                                        AllowResize="True" />

                            <infgDp:TextField AlternateBinding="{Binding Segment}"
                                        BindingType="UseAlternateBinding"
                                        Label="Сегмент"
                                        Width="Auto"
                                        AllowResize="True" />

                            <infgDp:TextField AlternateBinding="{Binding Manager}"
                                        BindingType="UseAlternateBinding"
                                        Label="Менеджер"
                                        Width="Auto"
                                        AllowResize="True" />

                            <infgDp:TextField AlternateBinding="{Binding ContractNumber}"
                                        BindingType="UseAlternateBinding"
                                        Label="Договор"
                                        Width="Auto"
                                        AllowResize="True" />

                            <infgDp:DateTimeField AlternateBinding="{Binding ContractDate}"
                                            BindingType="UseAlternateBinding"
                                            Label="Дата договора"
                                            Width="Auto"
                                            AllowResize="True" />

                            <infgDp:TextField AlternateBinding="{Binding SpecificationNumber}"
                                        BindingType="UseAlternateBinding"
                                        Label="Спецификация"
                                        Width="Auto"
                                        AllowResize="True" />

                            <infgDp:DateTimeField AlternateBinding="{Binding SpecificationDate}"
                                            BindingType="UseAlternateBinding"
                                            Label="Дата спецификации"
                                            Width="Auto"
                                            AllowResize="True" />

                            <infgDp:DateTimeField AlternateBinding="{Binding OrderInTakeDate}"
                                            BindingType="UseAlternateBinding"
                                            Label="ОИТ"
                                            Width="Auto"
                                            AllowResize="True" />

                            <infgDp:TextField AlternateBinding="{Binding PaymentConditionSet}"
                                        BindingType="UseAlternateBinding"
                                        Label="Условия оплаты"
                                        Width="Auto"
                                        AllowResize="True" />

                            <infgDp:TextField AlternateBinding="{Binding DeliveryType}"
                                        BindingType="UseAlternateBinding"
                                        Label="Тип доставки"
                                        Width="Auto"
                                        AllowResize="True" />

                            <infgDp:TextField AlternateBinding="{Binding DeliveryAddress}"
                                        BindingType="UseAlternateBinding"
                                        Label="Адрес доставки"
                                        Width="Auto"
                                        AllowResize="True" />

                            <infgDp:NumericField AlternateBinding="{Binding ProductionTerm}"
                                           BindingType="UseAlternateBinding"
                                           Label="Срок производства"
                                           Width="Auto"
                                           AllowResize="True" />

                        </infgDp:FieldLayout.Fields>


                    </infgDp:FieldLayout>
                </infgDp:XamDataGrid.FieldLayouts>
            </infgDp:XamDataGrid>


            <Expander Grid.Row="3" IsExpanded="False" Header="Информация о КД" Visibility="{Binding CurrentUserIsManager, Mode=OneTime, Converter={StaticResource VisibilityConverter}}">
                <TextBox HorizontalScrollBarVisibility="Auto" 
                         VerticalScrollBarVisibility="Auto"
                         MaxHeight="300"
                         VerticalAlignment="Stretch"
                         Text="{Binding DesignDocumentationInfo, Mode=OneWay}"
                         IsReadOnly="True" 
                         Background="Transparent" 
                         BorderThickness="0"/>
            </Expander>

        </Grid>
    </GroupBox>
                       
</inf:ViewBase>