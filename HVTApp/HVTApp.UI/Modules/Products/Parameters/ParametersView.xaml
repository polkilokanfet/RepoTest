<inf:ViewBase xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
              xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
              xmlns:infg="http://infragistics.com/DataPresenter"
              xmlns:inf="clr-namespace:HVTApp.Infrastructure;assembly=HVTApp.Infrastructure"
              xmlns:prism="http://prismlibrary.com/" 
              xmlns:views="clr-namespace:HVTApp.UI.Views"
              xmlns:controls="clr-namespace:HVTApp.UI.Controls"
              prism:ViewModelLocator.AutoWireViewModel="True"
              x:Class="HVTApp.UI.Modules.Products.Parameters.ParametersView">

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="3*"/>
        </Grid.ColumnDefinitions>

        <GroupBox Header="Параметры" Grid.Column="0">
            <infg:XamDataGrid DataSource="{Binding ParameterLookups}"
                              ActiveDataItem="{Binding SelectedParameterLookup, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">

                <infg:XamDataGrid.FieldLayouts>
                    <infg:FieldLayout>
                        <infg:FieldLayout.Fields>
                            <infg:TextField Name="Value" Label="Значение" Width="150" AllowResize="True"/>
                            <infg:TextField Name="ParameterGroup" Label="Группа" Width="150" Converter="{StaticResource LookupToStringConverter}" AllowResize="True"/>
                            <infg:TextField Name="Comment" Label="Комментарий" Width="50" AllowResize="True"/>
                        </infg:FieldLayout.Fields>
                    </infg:FieldLayout>

                </infg:XamDataGrid.FieldLayouts>
            </infg:XamDataGrid>
        </GroupBox>
        <GridSplitter Grid.Column="0" HorizontalAlignment="Right" Width="3"/>

        <GroupBox Grid.Column="1" Header="Детали">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <views:ParameterDetailsView DataContext="{Binding}" VisibilityParameterRelationsParameter="Collapsed"/>

                <GroupBox Grid.Row="1" Header="Обязательные параметры, выбранные перед этим">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <GroupBox Header="Ограничения" Grid.Column="0">
                            <infg:XamDataGrid DataSource="{Binding Item.ParameterRelations}" 
                                              ActiveDataItem="{Binding SelectedRelation, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                              Style="{StaticResource ListViewGrid}" >
                                <infg:XamDataGrid.FieldLayouts>
                                    <infg:FieldLayout>
                                        <infg:FieldLayout.Fields>
                                            <infg:TextField AlternateBinding="{Binding}" BindingType="UseAlternateBinding" Label="Ограничение" Width="Auto" />
                                        </infg:FieldLayout.Fields>
                                    </infg:FieldLayout>
                                </infg:XamDataGrid.FieldLayouts>
                            </infg:XamDataGrid>
                        </GroupBox>

                        <GridSplitter Grid.Column="1" HorizontalAlignment="Center"/>

                        <GroupBox Header="Параметры ограничения" Grid.Column="2">
                            <infg:XamDataGrid DataSource="{Binding SelectedRelation.RequiredParameters, UpdateSourceTrigger=PropertyChanged}" 
                                              ActiveDataItem="{Binding SelectedParameterInRelation}"
                                              Style="{StaticResource ListViewGrid}" >
                                <infg:XamDataGrid.FieldLayouts>
                                    <infg:FieldLayout>
                                        <infg:FieldLayout.Fields>
                                            <infg:TextField Name="Value" Label="Значение" Width="150" />
                                            <infg:TextField Name="ParameterGroup" Label="Группа" Width="150" Converter="{StaticResource WrapperToStringConverter}"/>
                                        </infg:FieldLayout.Fields>
                                    </infg:FieldLayout>
                                </infg:XamDataGrid.FieldLayouts>
                            </infg:XamDataGrid>
                        </GroupBox>

                        <GridSplitter Grid.Column="3" HorizontalAlignment="Center"/>

                        <GroupBox Header="Потенциальные параметры ограничения" Grid.Column="4">
                            <infg:XamDataGrid DataSource="{Binding PotentialRelationParameters, UpdateSourceTrigger=PropertyChanged}"
                                              SelectedDataItem="{Binding SelectedPotentialParameter, Mode=TwoWay}">
                                <infg:XamDataGrid.FieldLayouts>
                                    <infg:FieldLayout>
                                        <infg:FieldLayout.Fields>
                                            <infg:TextField Name="Value" Label="Значение" Width="150" />
                                            <infg:TextField Name="ParameterGroup" Label="Группа" Width="150" Converter="{StaticResource WrapperToStringConverter}"/>
                                        </infg:FieldLayout.Fields>
                                    </infg:FieldLayout>
                                </infg:XamDataGrid.FieldLayouts>
                            </infg:XamDataGrid>
                        </GroupBox>


                    </Grid>
                </GroupBox>
                <GridSplitter Grid.Row="1" VerticalAlignment="Bottom" Height="3"/>

                <GroupBox Grid.Row="2" Header="Пути выбора">
                    <infg:XamDataGrid DataSource="{Binding Paths}" Style="{StaticResource ListViewGrid}" >
                        <infg:XamDataGrid.FieldLayouts>
                            <infg:FieldLayout>
                                <infg:FieldLayout.Fields>
                                    <infg:TextField AlternateBinding="{Binding}" BindingType="UseAlternateBinding" Label="Путь" Width="Auto" />
                                </infg:FieldLayout.Fields>
                            </infg:FieldLayout>
                        </infg:XamDataGrid.FieldLayouts>
                    </infg:XamDataGrid>
                </GroupBox>
                <GridSplitter Grid.Row="2" VerticalAlignment="Bottom" Height="3"/>

                <GroupBox Grid.Row="3" Header="Блоки продуктов">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <GroupBox Grid.Column="0" Header="Параметры (отбора)">
                            <controls:ChooseItemsListControl 
                                Items="{Binding}"
                                AddItemCommand="{Binding}"
                                RemoveItemCommand="{Binding}"/>
                        </GroupBox>
                        <GridSplitter Grid.Column="0" HorizontalAlignment="Right" Width="3"/>

                        <GroupBox Grid.Column="1" Header="Блоки"></GroupBox>
                        <GridSplitter Grid.Column="0" HorizontalAlignment="Right" Width="3"/>

                        <GroupBox Grid.Column="2" Header="Параметры (блока)"></GroupBox>
                    </Grid>
                </GroupBox>

            </Grid>
        </GroupBox>

    </Grid>


</inf:ViewBase>